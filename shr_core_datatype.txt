Grammar:		DataElement 5.0
Namespace:		shr.core
Description:	"The SHR Core domain contains definitions for a variety of general-purpose elements that are used widely in SHR. These include definitions for coding, expressions of time, quantities, addresses, names, and more."

Path:			FHIR = http://hl7.org/fhir/ValueSet
// CodeSystem:     CC = http://www.nationsonline.org/oneworld/country_code_list
CodeSystem:     LNC = http://loinc.org
CodeSystem:     SCT = http://snomed.info/sct
CodeSystem:     MTH = http://ncimeta.nci.nih.gov
CodeSystem:		NCI = https://evs.nci.nih.gov/ftp1/CDISC/SDTM/
CodeSystem:     UCUM = http://unitsofmeasure.org 


//------------ Data Types aligned to FHIR ---------------

Element:		Text
Description:	"A simple string."
Value:			string

Element:		Quantity
Description:	"A quantity with units, whose value may be bounded from above or below, as defined in FHIR"
0..1 			Number
0..1			Comparator
0..1			Units

		Element:		Number
		Description:	"A decimal value."
		Value:			decimal

		Element:		Comparator
		Description:	"A code indicated if the value represents an upper or lower bound"
		Value:			CodeableConcept from http://hl7.org/fhir/ValueSet/quantity-comparator

		Element:		Units
		Description:	"The unit of measure of the quantity."
		Value:			Coding

Element:		SimpleQuantity
Based on:		Quantity
Description:	"A quantity where the comparator is not used, as defined in FHIR"
0..0			Comparator

Element:		IntegerQuantity
Based on:		Quantity
Description:	"A Quantity that is an integer."
				Units is UCUM#1

Element:		Age
Based on:		Quantity
Concept:		MTH#C0001779
Description:	"How long someone has been alive, or something has existed."
				Units from http://hl7.org/fhir/ValueSet/age-units if covered

Element:		Distance
Based on:		Quantity
Concept:		MTH#C0012751
Description:	"The measure of space separating two objects or points."
				Units from http://hl7.org/fhir/ValueSet/distance-units if covered

Element:		Duration
Based on:		SimpleQuantity
Concept:		MTH#C0449238
Description:	"The length of time that something continues."
				Units from http://hl7.org/fhir/ValueSet/duration-units if covered

Element:		Money  // structural changes in R4
Description:	"Representation of an amount of currency or monetary value."
0..1			MoneyAmount
0..1			Currency

			Element:	MoneyAmount
			Description: "Numerical value (with implicit precision)"
			Value:		decimal

			Element:	Currency
			Description: "ISO 4217 Currency Code"
			Value:      code from http://hl7.org/fhir/ValueSet/currencies

Element:		Coding
Concept:		MTH#C0805701
Description:	"Coding of a concept, drawn from a controlled vocabulary. Includes the vocabulary and version, if applicable. May include a display text, and a descriptor expressing the intended interpretation of the code."
0..1			CodeValue
0..1			CodeSystem
0..1 			CodeSystemVersion
0..1			DisplayText
	
	Element:		CodeValue
	Description:	"A coded value, or expression, in syntax defined by the system"
	Value:			code

	Element:		CodeSystem
	Description:	"A formal terminology system."
	Value:			uri

	Element:		CodeSystemVersion
	Description:	"The version of the vocabulary being used, if applicable."
	Value:			string // Should be id type in FHIR, but it is a string (no issue recorded yet)
	
Element:		CodeableConcept
Description:	"A set of codes drawn from different coding systems, representing the same concept."
0..*			Coding
0..1			DisplayText

Element:		Code
Description:	"The main type identifier for a lab, procedure, condition, etc., usually drawn from a controlled vocabulary."
Value:			CodeableConcept

Element:		Range
Description:	"An interval defined by a quantitative upper and/or lower bound. One of the two bounds must be specified, and the lower bound must be less than the upper bound. When Quantities are specified, the units of measure must be the same."
0..1			LowerBound
0..1			UpperBound

	Element:		LowerBound
	Description:	"The lower limit on a range"
	Value:			SimpleQuantity  // or decimal or unsignedInt or integer 

	Element:		UpperBound
	Description:	"The upper limit on a quantitative value."
	Value:			SimpleQuantity  // or decimal or unsignedInt or integer 

	
Element:		Ratio
Description:	"A unit of measurement for the quotient of the amount of one entity to another."
0..1			Numerator
0..1			Denominator

	Element:		Numerator
	Description:	"The dividend of a fraction."
	Value:			Quantity

	Element:		Denominator
	Description:	"The divisor of a fraction."
	Value:			Quantity

Element:   		ContactPoint
Description:	"An electronic means of contacting an organization or individual."		
0..1			TelecomNumberOrAddress
0..1			Type from http://hl7.org/fhir/ValueSet/contact-point-system
0..1			Purpose from http://hl7.org/fhir/ValueSet/contact-point-use
0..1			PriorityRank
0..1			EffectiveTimePeriod

		Element:		TelecomNumberOrAddress
		Description:	"A user name or other identifier on a telecommunication network, such as a telephone number (including country code and extension, if necessary), email address, or SkypeID."
		Value:			string	
		
		Element:		Type
		Concept:		MTH#C0332307
		Description:	"A code describing the item at a greater level of detail." 
		Value:			CodeableConcept
		
		Element:		Purpose
		Description:	"Description of the intent or use of the item."
		Value:			CodeableConcept

		Element:	PriorityRank
		Description:	"The priority of the procedure, as a number (1 being the highest priority)"
		Value:		positiveInt 


Element:		TimePeriod
Description:	"A period of time defined by a start and end time, date, or year. 
If the start date/time is missing, the start of the period is not known. If the end date/time is missing, it means that the period is ongoing."
0..1			BeginDateTime
0..1			EndDateTime  // lack of end time indicates the period was continuing at the time the entry was created

	Element: 		BeginDateTime    // synonym "EffectiveDate"
	Description: 	"The time at which something is to take effect, start, or did start. Boundary is considered inclusive."
	Value:			dateTime   // TODO: would like to have date or dateTime but that wouldn't be FHIR-compatible

	Element:		EndDateTime
	Description:	"The time at which something is to end or did end. Boundary is considered inclusive."
	Value:			dateTime   // TODO: would like to have date or dateTime but that wouldn't be FHIR-compatible


Element: 	Timing
Description: "A timing schedule that specifies an event that may occur multiple times. 
Timing offers a choice of multiple OccurrenceTime (used is used to specify specific times), or recurrence patterns."
0..*		OccurrenceTime
0..1		TimingCode
0..1		Repeat

	Element:		TimingCode
	Description: 	"A code for the timing schedule (or just text in code.text). Some codes such as BID are ubiquitous, but many institutions define their own additional codes. If a code is provided, the code is understood to be a complete statement of whatever is specified in the structured timing data, and either the code or the data may be used to interpret the Timing, with the exception that .repeat.bounds still applies over the code (and is not contained in the code)."
	Value:			CodeableConcept from http://hl7.org/fhir/ValueSet/timing-abbreviation if covered
	
	Element:	Repeat
	Description: "A set of rules that describe when a recurring event is scheduled."
	0..1		RepeatBounds
	0..1		RepeatCount
	0..1		RepeatCountMax
	0..1		RepeatDuration
	0..1		RepeatDurationMax
	0..1		RepeatDurationUnit
	0..1		RepeatFrequency
	0..1		RepeatFrequencyMax
	0..1		RepeatPeriod
	0..1		RepeatPeriodMax
	0..1		RepeatPeriodUnit
	0..*		DayOfWeek
	0..*		TimeOfDay
	0..*		DailyLifeEvent
	0..1		DailyLifeEventOffset

		Element:		RepeatBounds
		Description:	"Either a duration for the length of the timing schedule, a range of possible length, or outer bounds for start and/or end limits of the timing schedule."
		Value:			Duration or Range or TimePeriod

		Element:		RepeatCount
		Description:	"A total count of the desired number of repetitions across the duration of the entire timing specification. If countMax is present, this element indicates the lower bound of the allowed range of count values."
		Value:	   		positiveInt // integer in STU3

		Element: 		RepeatCountMax
		Description:	"If present, indicates that the count is a range - so to perform the action between [count] and [countMax] times."
		Value:	   		positiveInt // integer in STU3

		Element:		RepeatDuration
		Description:	"How long this thing happens for when it happens. If durationMax is present, this element indicates the lower bound of the allowed range of the duration."
		Value:			decimal

		Element:		RepeatDurationMax
		Description:	"If present, indicates that the duration is a range - so to perform the action between [duration] and [durationMax] time length."
		Value:			decimal

		Element:		RepeatDurationUnit
		Description:	"The units of time for the duration, in UCUM units."
		Value:			code from http://hl7.org/fhir/ValueSet/units-of-time

		Element:		RepeatFrequency
		Description:	"The number of times to repeat the action within the specified period. If frequencyMax is present, this element indicates the lower bound of the allowed range of the frequency."
		Value:	   		positiveInt // integer in STU3

		Element:		RepeatFrequencyMax
		Description:	"If present, indicates that the frequency is a range - so to repeat between [frequency] and [frequencyMax] times within the period or period range."
		Value:	   		positiveInt // integer in STU3

		Element:		RepeatPeriod
		Description:	"Indicates the duration of time over which repetitions are to occur; e.g. to express '3 times per day', 3 would be the frequency and '1 day' would be the period. If periodMax is present, this element indicates the lower bound of the allowed range of the period length."
		Value:			decimal

		Element:		RepeatPeriodMax
		Description:	"If present, indicates that the period is a range from [period] to [periodMax], allowing expressing concepts such as 'do this once every 3-5 days.' "
		Value:			decimal

		Element:		RepeatPeriodUnit
		Description:	"The units of time for the period in UCUM units."
		Value:			code from http://hl7.org/fhir/ValueSet/units-of-time

		Element:		DayOfWeek
		Description:	"If one or more days of week is provided, then the action happens only on the specified day(s)."
		Value:			CodeableConcept from http://hl7.org/fhir/ValueSet/days-of-week
		
		Element:		TimeOfDay
		Description:	"Time of day the event should take place on the designated day(s)."
		Value:			time
		
		Element:		DailyLifeEvent
		Description:	"An approximate time period during the day, potentially linked to an event of daily living that indicates when the action should occur."
		Value:			CodeableConcept from http://hl7.org/fhir/ValueSet/event-timing

		Element:		DailyLifeEventOffset
		Description:	"The number of minutes from the event. If the event code does not indicate whether the minutes is before or after the event, then the offset is assumed to be after the event."
		Value:			unsignedInt


Element:	SampledData
Description:	"Data that comes from a series of measurements taken by a device, which may have upper and lower limits. The data type also supports more than one dimension in the data."
1..1		DataAsString
1..1		Origin
1..1		MillisecondsBetweenSamples
0..1		CorrectionFactor
0..1		LowerLimit
0..1		UpperLimit
1..1		Dimensions

	Element:	DataAsString
	Description:	"Data represented as a text sting."
	Value:		string

	Element:	Origin
	Description:	"The shr.base quantity that a measured value of zero represents. In addition, this provides the units of the entire measurement series."
	Value:		SimpleQuantity
	
	Element:	MillisecondsBetweenSamples
	Description: "The length of time between sampling times, measured in milliseconds."
	Value:		decimal
	
	Element:	CorrectionFactor
	Description: "A correction factor that is applied to the sampled data points before they are added to the origin."
	Value:		decimal
	
	Element:	LowerLimit	
	Description:	"The lower limit of detection of the measured points. This is needed if any of the data points have the value 'L' (lower than detection limit)."
	Value:		decimal
	
	Element:	UpperLimit
	Description:	"The upper limit of detection of the measured points. This is needed if any of the data points have the value 'U' (higher than detection limit)."
	Value:		decimal
	 
	Element:	Dimensions
	Description:	"The number of sample points at each time point. If this value is greater than one, then the dimensions will be interlaced - all the sample points for a point in time will be recorded at once."
	Value:		positiveInt
	
Element:   		Address
Description:    "An address expressed using postal conventions (as opposed to GPS or other location definition formats). This data type may be used to convey addresses for use in delivering mail as well as for visiting locations and which might not be valid for mail delivery. There are a variety of postal address formats defined around the world. (Source: HL7 FHIR)."
0..1			Purpose from http://hl7.org/fhir/ValueSet/address-use
0..1			Type from http://hl7.org/fhir/ValueSet/address-type
0..1			DisplayText
0..*    		AddressLine
0..1    		City
0..1    		District
0..1    		State
0..1    		PostalCode
0..1    		Country
0..1			EffectiveTimePeriod

	Element:    	AddressLine
	Description:    "Part of an address that contains the house number, apartment number, street name, street direction, P.O. Box number, delivery hints, and similar address information. (Source: HL7 FHIR)."
	Value:         	string

	Element:    	City
	Description:    "The name of a municipality, city, town, village or other community or delivery center. (Source: HL7 FHIR)."
	Value:         	string

	Element:    	District
	Description:    "The name of the administrative area at a level below that of a state but above that of a city or town. In the US, a county. Outside the US, a district or the equivalent. (Source: HL7 FHIR)."
	Value:         	string

	Element:    	State
	Description:    "Sub-unit of a country with limited sovereignty in a federally organized country. A code may be used if codes are in common use (i.e. US 2 letter state codes). (Source: HL7 FHIR)."
	Value:         	string

	Element:    	PostalCode
	Description:    "A sequence of letters and digits used as part of a postal address, often designating a geographic region"
	Value:         	string

	Element:    	Country
	Description:    "Country - a nation as commonly understood or generally accepted, expressed in ISO 3166 Alpha-2 (2-letter) codes."
	Value:         	string

//------------ Complex Data Types not in FHIR ----------------

Element:		Count
Description:	"The number of items (0 or more), as an integer."
Value:			unsignedInt

Element:		CommentOrDescription
Description:	"A text note containing additional details, explanation, description, comment, or summarization."
Value:			string

Element:		DurationRange
Based on:		Range
Description:	"A range of durations."
				LowerBound value is type Duration
				UpperBound value is type Duration

Element: 		PriorityCode
Description:	"An indication of the importance of an action relative to other actions."
Value:			positiveInt or CodeableConcept

Element:		Percentage
Based on:		SimpleQuantity
Description:	"A percentage value where 100.0 represents 100%."
				Units is UCUM#%

Element:        CanonicalUrl
Description:    "A URI that refers to a resource by its canonical URL (resources with a url property). The canonical type differs from a uri in that it has special meaning in this specification, and in that it may have a version appended, separated by a vertical bar (|)."
Value:          uri


Element:  Relationship
Description:  "A description of the association between people or items."
Value:	CodeableConcept


//-------------- Duration and Frequency  -----------------


Element:		Frequency   // TODO: should be a ratio, but the problem is that ratio uses Quantity in numerator and denominator
Based on:		Ratio
Concept:		MTH#C0376249
Description:	"How many occurrences of an event per unit of time."
				Numerator.Quantity with units UCUM#1
				Denominator.Quantity.Units from http://hl7.org/fhir/ValueSet/units-of-time


//------------- Interpretations of Time -------------------

Element:		EffectiveTimePeriod
Based on:		TimePeriod
Concept:		MTH#C2985763
Description:	"The date and time span for which something is active, valid, or in force."

Element:		ReceivedTime
Concept:		MTH#C2735124	
Description:	"Time the item was delivered to, or accepted by, the receiving facility or unit."
Value:			dateTime

Element:		OccurrenceTimeOrPeriod
Description:	"The point or period of time when the event takes place. Times can be precise (dateTime) or approximate (date). If a time period is used, and the start date or dateTime is missing, the start of the period is not known. If the end date or dateTime is missing, it means that the period is ongoing."
Value:			date or dateTime or TimePeriod

Element:		NonOccurrenceTimeOrPeriod
Description:	"The point in time or span of time in which something did not happen."
Value:			date or dateTime or TimePeriod

Element:		OccurrenceTime
Based on:		OccurrenceTimeOrPeriod
Description:	"The point in time in which something happens."
Value:			dateTime

Element:		OccurrencePeriod
Based on:		OccurrenceTimeOrPeriod
Description:	"The point in time or span of time in which something happens."
Value:			TimePeriod

Element:		OccurrenceDuration
Description:	"The length of time in which something happens."
Value:			Duration


//---------------  Positions and Addresses -----------------

Element:		Geoposition
Description:	"The location on the surface of the Earth, described by a latitude and longitude (and optional altitude)."
1..1			Latitude
1..1			Longitude
0..1			Altitude

		Element:		Latitude
		Description:	"The angular distance north or south between an imaginary line around a heavenly body parallel to its equator and the equator itself. Measured with with WGS84 datum."
		Value:			decimal

		Element:		Longitude
		Description:	"An imaginary great circle on the surface of a heavenly body passing through the poles at right angles to the equator. Measured with with WGS84 datum."
		Value:			decimal

		Element:		Altitude
		Description:	"Height above sea level or above the earth's surface. Measured with with WGS84 datum."
		Value:			decimal


Element:		Setting
Description:	"Description of the place or type of surroundings where something is positioned or where an event takes place."
Value:			CodeableConcept from SettingVS


Element:    	UnitedStatesAddress
Based on:		Address
Description:    "An address for a place in the USA, conforming to US mail postal conventions. (Source: HL7 FHIR)."
1..1			State is type UnitedStatesState
1..1			Country // is "US"   // fixed -- string constraints not yet supported

	Element:		UnitedStatesState
	Based on:		State
	Description:	"A state or territory in the USA expressed by 2-letter US Postal code."

Element:		DisplayText
Description:	"A string meant for reading by a person, for example, accompanying a code."
Value:			string

Element:		VersionString
Description:	"A string associated with the product that identifies a particular release iteration."
Value:			string

Element:		Title
Description:	"A distinguishing word or group of words naming an item."
Value:			string

Element:		EmbeddedContent
Description:	"Abstract class defining the common metadata of all types of encapsulated data, such as images."

Element:		ParsableContent
Based on:		EmbeddedContent
Description:	"A string that follows a formal syntax and can be analyzed and broken into meaningful parts."
1..1			Text
1..1			Formalism

	Element:		Formalism
	Description:	"The system of formal syntax or interpretation associated with parsable content."
	Value:			CodeableConcept


	Element:		BinaryData
	Description:	"The data itself."
	Value:			base64Binary

	Element:		ContentType
	Description:	"The mime type of the content, with charset etc."
	Value:			CodeableConcept

	Element:		ResourceSize
	Description:	"Number of bytes of content in the resource (if url provided)"
	Value:			unsignedInt

	Element:		Hash
	Description:	"A hash code of the data (sha-1, base64ed)"
	Value:			base64Binary

	Element:   	 	CreationDateTime  
	Concept:        MTH#C3669169
	Description:    "The point in time when the item was created."
	Value:          dateTime  // we can map to instant from dateTime


Element:		Identifier
Description:	"Business identifier or external id for this resource."
0..1			IdentifierString  
0..1			Purpose from http://hl7.org/fhir/ValueSet/identifier-use
0..1			Type from http://hl7.org/fhir/ValueSet/identifier-type if covered
0..1			CodeSystem
// 0..1			EffectiveTimePeriod
//0..1			Issuer -- commented out to prevent generating a profile on identifier caused by having profile on Organization (which is unavoidable in DSTU 2, because US Core changes some cardinalities to 1..)

		Element:		IdentifierString
		Description:	"An id for the item expressed as a string."
		Value:			string
		


Element:		Category
Description:	"The general type or class of this item."
Value:			CodeableConcept		

